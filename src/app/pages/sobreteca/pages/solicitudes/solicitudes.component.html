
   <!-- <loading></loading> -->
<div id="initial" class="dark:bg-gray-900 h-screen flex flex-col ">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-1">      
      <div class="  py-1 px-2 flex sm:flex-row flex-col sm:space-x-6 items-center">
  <h1 class="text-2xl text-center  text-slate-500">{{ titulo() }}</h1>
  
  <div class="w-3/4">
      <search-metrics  placeholder="Buscar sobre por OP" [typeSearch]="type" (onSelectOrder)="onSelectOrder($event)"  />
    </div>
  
  </div>
      <ejs-grid #grid 
        [dataSource]='ordenes()' [filterSettings]="filterSettings " [allowTextWrap]='true' [enableAdaptiveUI]='false' [enableHover]='true' rowHeight='30' (dataBound)='dataBound()'
        [allowExcelExport]='true' [height]="heightGrid" allowReordering='true' [allowFiltering]=true allowPaging="true " allowResizing="true" allowSorting="true"
        [pageSettings]='pageSettings'
        >
            <e-columns>
                <e-column field='NoOrden' headerText='OP' width='120' textAlign='Center' ></e-column>
               
                <e-column field='NombreTrabajo' headerText='Cliente' width='150' textAlign='Left' ></e-column>
                <e-column field='Vendedor' headerText='Vendedor' width='200' textAlign='Left' ></e-column>                
                
                <e-column field='no_gaveta' headerText='# Gaveta' width='150' textAlign='Center'  ></e-column>                
                <e-column >
                  <ng-template #template let-data>
                    <a  (click)="verDetalle(data)" class="flex items-center justify-start gap-1 text-blue-500 hover:underline hover:cursor-pointer">                      
                      <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <rect x="4" y="4" width="16" height="16" rx="3" stroke="currentColor" stroke-width="2" fill="none"/>
                        <path d="M8 10h8M8 14h5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                      Detalle
                    </a>
                  </ng-template>
                </e-column>
                </e-columns>
         </ejs-grid>
    </div>    
</div>


<p-dialog  #dialogModal [visible]="tieneOrdenSeleccionada()"  [maximizable]="true"  [showHeader]="false" [closeOnEscape]="false">
<ng-template #headless >        
  
  -
    <div class="w-full p-1  mx-auto mt-2">        
  <div class="flex flex-col md:flex-row justify-between items-center space-x-10 px-3">            
    <div class="flex flex-col">
      <h1 class="text-lg font-bold pb-2 ">{{ nombreTrabajo() }}</h1>      
    </div>             
        
    <div class="flex flex-row justify-end items-center space-x-4">      
<div class="flex flex-wrap items-center justify-center gap-1 ">                 
    </div> 
    <button
      class="flex items-center justify-center w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 text-gray-600 hover:text-gray-800 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-gray-300"
      (click)="cerrarDetalle()"
    >
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" >
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M6 18L18 6M6 6l12 12"></path>
      </svg>      
    </button>
    </div>         
  </div>
    </div>  
    
    <div class="flex sm:flex-row flex-col items-end justify-end px-2">        
      <div class="sm:w-1/2 md:2/3 w-full">
        @if(ordenActual()!.enPrestamo){
           <button  class="w-44 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-3 rounded-lg shadow-md hover:shadow-lg transform hover:-translate-y-0.5 transition-all duration-200 flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none">            
            Prestar Material
          </button>
          }@else
           {

          <div class="mx-5 mb-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-2">
    
    <div class="flex items-center mb-1">      
    </div>          
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2">      
      <div class="bg-white dark:bg-gray-800 rounded-lg p-1 border border-gray-200 dark:border-gray-700">
        <div class="flex items-center">
          <svg class="w-4 h-4 text-gray-500 dark:text-gray-400 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
          </svg>
          <span class="text-xs text-gray-500 dark:text-gray-400 font-medium">Fecha de Préstamo</span>
        </div>
        <p class="text-sm text-center font-semibold text-gray-800 dark:text-gray-200 mt-1">15/10/2024 - 14:30</p>
      </div>

      
      <div class="bg-white dark:bg-gray-800 rounded-lg p-1 border border-gray-200 dark:border-gray-700">
        <div class="flex  items-center">
          <svg class="w-4 h-4 text-gray-500 dark:text-gray-400 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
          </svg>
          <span class="text-xs text-gray-500 dark:text-gray-400 font-medium">Prestado a</span>
        </div>
        <p class="text-sm text-center font-semibold text-gray-800 dark:text-gray-200 mt-1">Juan Pérez</p>        
      </div>            
      
      <div class="bg-white dark:bg-gray-800 rounded-lg p-2 border border-gray-200 dark:border-gray-700">        
        <button class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2 px-3 rounded-md shadow-sm hover:shadow-md transform hover:-translate-y-0.5 transition-all duration-200 flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 text-sm">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"></path>
          </svg>
          Devolver Préstamo
        </button>
      </div>

  
      </div>
  </div>

        }
  

      </div>
      



    </div>



    
       <div class="bg-slate-300   dark:bg-gray-700 rounded-lg px-4 py-2 h-[calc(100vh-300px)] overflow-y-auto flex flex-wrap gap-4   mx-5 ">               
        @for(grupo of componentesAgrupados();track grupo.nombre;let i=$index) {
    <div class="bg-white border h-fit   dark:border-white dark:bg-slate-800 rounded shadow  w-full max-w-96   md:w-62 sm:w-60">
      <div class="w-full bg-slate-700  border-0 rounded  flex justify-between items-center">        
          <h2 class="text-lg font-bold  px-2 py-1 text-white dark:text-slate-100 ">{{ grupo.nombre }}</h2>
          
      </div>
        @for(elemento of grupo.elementos; track elemento.id) {
        <div  class="flex items-center justify-between py-1 border-b  p-4 last:border-b-0">
          <div class="flex flex-row space-x-2 text-[9px]">
            <div class=" text-slate-700 dark:text-white">{{ elemento.elemento }}</div>            
            <div class=" text-slate-500 dark:text-white">{{ elemento.proceso }}</div>            
          </div>                  
           <p-checkbox [ngModel]="true" [binary]="true" checked disabled="true"/>        
        </div>
      }
      </div>
      }      
    </div>
</ng-template>
</p-dialog>

