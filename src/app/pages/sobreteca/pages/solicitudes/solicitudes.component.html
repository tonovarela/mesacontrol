
   <!-- <loading></loading> -->
<div id="initial" class="dark:bg-gray-900 h-screen flex flex-col ">
    <div class="w-full mx-auto px-4 sm:px-6 lg:px-8 pt-1">      
      <div class="  py-1 px-2 flex sm:flex-row flex-col sm:space-x-6 items-center">
  <h1 class="text-2xl text-center  text-slate-500">{{ titulo() }}</h1>
  
  <div class="w-3/4">
      <search-metrics  placeholder="Buscar sobre por OP" [typeSearch]="type" (onSelectOrder)="onSelectOrder($event)"  />
    </div>
  
  </div>
        <!-- <ejs-grid #grid 
        [dataSource]='ordenes()' [filterSettings]="filterSettings " [allowTextWrap]='true' [enableAdaptiveUI]='false' [enableHover]='true' rowHeight='30' (dataBound)='dataBound()'
        [allowExcelExport]='true' [height]="heightGrid" allowReordering='true' [allowFiltering]=true allowPaging="true " allowResizing="true" allowSorting="true"
        [pageSettings]='pageSettings'
        >
            <e-columns>
                <e-column field='NoOrden' headerText='OP' width='120' textAlign='Center' ></e-column>
                <e-column field='descripcion' headerText='Estado' width='120'  >
                  <ng-template #template let-data>
                  <span class="px-2 inline-flex  leading-5 font-semibold rounded-full"
                    [ngClass]="{
                      'bg-green-100 text-green-800': data.id_estado == 2,
                      'bg-yellow-100 text-yellow-800': data.id_estado == 1,
                      'bg-red-100 text-red-800': data.id_estado == 3,
                      'bg-gray-100 text-gray-800': data.id_estado == 5,
                    }"
                  >
                    {{ data.descripcion }}
                  </span>
                 </ng-template>
                </e-column>
                <e-column field='NombreTrabajo' headerText='Cliente' width='150' textAlign='Left' ></e-column>
                <e-column field='Vendedor' headerText='Vendedor' width='200' textAlign='Left' ></e-column>                
                
                <e-column field='no_gaveta' headerText='# Gaveta' width='150' textAlign='Center'  >
                  <ng-template #template let-data>

                    @if(data.id_estado == '2') {
                    <span *ngIf="data.no_gaveta; else sinGaveta">{{ data.no_gaveta }}</span>
                    <ng-template #sinGaveta>
                       <button class=" my-1 px-2  bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-300 border border-blue-200 dark:border-blue-700 rounded-md text-[10px] font-medium hover:bg-blue-200 dark:hover:bg-blue-800 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-400/50 flex items-center gap-2"
                            (click)="actualizarGaveta(data.NoOrden)"
                            title="Actualizar número de gaveta"
                          >
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
        </svg>
        Gaveta
      </button>
          
                    </ng-template>
                  }
                  </ng-template>
                </e-column>
                
                <e-column >
                  <ng-template #template let-data>
                    <a  (click)="verDetalle(data)" class="flex items-center justify-start gap-1 text-blue-500 hover:underline hover:cursor-pointer">                      
                      <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <rect x="4" y="4" width="16" height="16" rx="3" stroke="currentColor" stroke-width="2" fill="none"/>
                        <path d="M8 10h8M8 14h5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                      Detalle
                    </a>
                  </ng-template>
                </e-column>
                </e-columns>
         </ejs-grid> -->
    </div>    
</div>


<!-- <p-dialog  #dialogModal [visible]="tieneOrdenSeleccionada()"   [maximizable]="true"  [showHeader]="false" [closeOnEscape]="false">
<ng-template #headless >        
  
        <div class="w-full p-1  mx-auto mt-2">        
  <div class="flex flex-col md:flex-row justify-between items-center space-x-10 px-3">            
    <div class="flex flex-col">
      <h1 class="text-lg font-bold pb-2 ">{{ nombreTrabajo() }}</h1>      
    </div>             
    @if(ordenActual()!.id_estado !='2'){       
<div class="p-2  text-xs font-semibold rounded-lg"
          [ngClass]="{
            'bg-green-100 text-green-800': ordenActual()!.id_estado == '2',
            'bg-yellow-100 text-yellow-800': ordenActual()!.id_estado == '1',
            'bg-red-100 text-red-800': ordenActual()!.id_estado == '3',
            'bg-gray-100 text-gray-800': ordenActual()!.id_estado == '5'
          }"
        >        
          {{ ordenActual()!.descripcion }}
        </div>

    }
    
    <div class="flex flex-row justify-end items-center space-x-4">      
<div class="flex flex-wrap items-center justify-center gap-1 ">      
  @if(ordenActual()!.id_estado =='2'){
  <div
      class="inline-block px-3  w-72  rounded-md text-md font-semibold bg-green-100 text-green-700 border-green-200 dark:bg-green-900 dark:text-green-200 dark:border-green-700'   "
      >
    <div class="flex items-center space-x-2 text-green-600 dark:text-green-400 py-1 ">
        <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
        </svg>
        <div class="flex flex-col">
          <span class="text-sm font-medium">{{liberacionInfo()?.motivo }}</span>
          <span class="text-xs font-light text-gray-500 dark:text-gray-400">            
            {{ liberacionInfo()?.fecha_registro  | date : "dd-MM-yyyy" }}
          </span>
        </div>
      </div>
    </div>   
  }


      @if(estaEnAprobacion()) {
      <button
        class="px-4 py-2 bg-gray-100 text-green-600 dark:bg-gray-800 dark:text-green-400 border border-gray-200 dark:border-gray-700 rounded-md text-xs font-medium hover:bg-gray-200 dark:hover:bg-gray-700 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-green-400/50"
        (click)="aprobar()"
      >
        Aprobar
      </button>
      <button
        class="px-4 py-2 bg-gray-100 text-red-600 dark:bg-gray-800 dark:text-red-400 border border-gray-200 dark:border-gray-700 rounded-md text-xs font-medium hover:bg-gray-200 dark:hover:bg-gray-700 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-red-400/50"
        (click)="rechazar()"
      >
        Rechazar
      </button>
      } 
      @if(estaPendiente() ){      
      <button
        class="px-4 py-2 bg-gray-100 text-green-600 dark:bg-gray-800 dark:text-green-400 border border-gray-200 dark:border-gray-700 rounded-md text-xs font-medium hover:bg-gray-200 dark:hover:bg-gray-700 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-green-400/50"
        (click)="solicitarAprobacion()"
      >
        Solicitar aprobación
      </button>
      }
      
         
    </div> 
    <button
      class="flex items-center justify-center w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 text-gray-600 hover:text-gray-800 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-gray-300"
      (click)="cerrarDetalle()"
    >
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" >
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M6 18L18 6M6 6l12 12"></path>
      </svg>      
    </button>
    </div>         
  </div>
       </div>  
    <div class="bg-slate-300   dark:bg-gray-700 rounded-lg px-4 py-2 h-[calc(100vh-100px)] overflow-y-auto flex flex-wrap gap-4   mx-5 ">               
        @for(grupo of componentesAgrupados();track grupo.nombre;let i=$index) {
    <div class="bg-white border h-fit   dark:border-white dark:bg-slate-800 rounded shadow  w-full max-w-96   md:w-62 sm:w-60">
      <div class="w-full bg-slate-700  border-0 rounded  flex justify-between items-center">        
          <h2 class="text-lg font-bold  px-2 py-1 text-white dark:text-slate-100 ">{{ grupo.nombre }}</h2>
          <div class="px-4">
           <p-checkbox     
           
          [binary]="true" 
          (onChange)="toggleGrupo(i,$event)"
          [disabled]="!estaPendiente()">
        </p-checkbox>          
          </div>                        
      </div>
        @for(elemento of grupo.elementos; track elemento.id) {
        <div  class="flex items-center justify-between py-1 border-b  p-4 last:border-b-0">
          <div class="flex flex-row space-x-2 text-[9px]">
            <div class=" text-slate-700 dark:text-white">{{ elemento.elemento }}</div>            
            <div class=" text-slate-500 dark:text-white">{{ elemento.proceso }}</div>            
          </div>        
           <p-checkbox                      
           [(ngModel)]="elemento.aplica"
           (ngModelChange)="onCheckboxChange(elemento.id,elemento.aplica)"
          [binary]="true" 
          [disabled]="!estaPendiente()">
        </p-checkbox>          
        </div>
      }
      </div>
      }      
    </div>
</ng-template>
</p-dialog> -->

